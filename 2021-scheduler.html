<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>2021 Scheduler - Anki Betas</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html">Intro &amp; Downloads</a></li><li class="chapter-item expanded "><a href="2021-scheduler.html" class="active">2021 Scheduler</a></li><li class="chapter-item expanded "><a href="anki2.1.44.html">Changes in 2.1.44</a></li><li class="chapter-item expanded "><a href="anki2.1.43.html">Changes in 2.1.43</a></li><li class="chapter-item expanded "><a href="anki2.1.41.html">Changes in 2.1.41</a></li><li class="chapter-item expanded "><a href="older.html">Older</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Anki Betas</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/ankitects/anki-betas/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#2021-scheduler" id="2021-scheduler">2021 Scheduler</a></h1>
<p>The 2021 scheduler (&quot;v3&quot;) is an update to the <a href="https://faqs.ankiweb.net/the-anki-2.1-scheduler.html">Anki 2.1
scheduler</a> (&quot;v2&quot;). An
alpha version will become available when 2.1.45alpha1 is released. The design is
not set in stone yet, so feedback on what you like and don't like would be
appreciated.</p>
<h2><a class="header" href="#compatibility" id="compatibility">Compatibility</a></h2>
<p>The v2 and v3 schedulers are compatible. You can switch between them without
a full sync, and it will not cause scheduling issues if you use v3 on one
device and sync to another device that is using v2.</p>
<p>Because the v3 scheduler uses a different approach to gathering and sorting
cards, there is a good chance that the number of cards you are presented with
will differ if you switch back and forth - so while it should not cause scheduling
issues, it may be a little confusing.</p>
<h2><a class="header" href="#changes" id="changes">Changes</a></h2>
<h3><a class="header" href="#undo" id="undo">Undo</a></h3>
<p>The v3 scheduler uses Anki's new undo infrastructure - you can answer a card,
bury a different card, and answer another card, then undo each one in turn if
you wish. Previous schedulers handled undo separately, so a non-review action
would clear the review history, and vice versa.</p>
<h3><a class="header" href="#daily-limits" id="daily-limits">Daily limits</a></h3>
<p>Previously each deck's limit was limited by the its parent limits, grandparent
limits, and so on. This has been simplified to the following:</p>
<ul>
<li>Each deck's limit controls how many cards from that specific deck can be used.</li>
<li>The deck you select controls the maximum number of cards that will be shown in
the study session.</li>
</ul>
<p>For example, imagine you have a parent deck with a limit of 100, with 2 child
decks. The first one has a limit of 20, and the second has a limit of 200.</p>
<ul>
<li>If you click on the parent deck, you will get a maximum of 100 cards.</li>
<li>If you click on the first child, you'll get a maximum of 20 cards.</li>
<li>If you click on the second child, you'll get a maximum of 200 cards.</li>
</ul>
<p>This may sound similar to the way reviews are handled in the v2 scheduler. The
difference is that each child deck's limit is also enforced. When you click on
the parent deck, you will not get more than 20 cards from the first child. You
do not need to see the cards in deck order either - see the Sorting section
below for more.</p>
<p>Another change is that the new count is now capped by the review count. If you
have limits of 200 reviews and 20 new cards, and 190 reviews are due, only 10
new cards will be introduced.</p>
<h3><a class="header" href="#sorting" id="sorting">Sorting</a></h3>
<p>Additional deck options have been added to control the order new cards and
reviews are presented in. New cards can be mixed from multiple decks, and
reviews can be ordered by interval.</p>
<p>When burying is disabled, it is now possible to control whether siblings are
shown together or not.</p>
<p>The options controlling the mixing of new cards and interday learning cards have
been moved from the Preferences screen into the deck options. The options will
be used from the deck you select to study.</p>
<h3><a class="header" href="#burying" id="burying">Burying</a></h3>
<p>When burying is enabled, cards are now excluded from the queues at the start of
a study session. Previously if you had 10 forward and 10 reverse cards, the
counts would start at 20 and jump down as you review, but now they'll start directly
at 10. The actual burying still happens as you review cards.</p>
<p>Because exclusion is done when you click on a deck, the counts you see on the deck
list will differ from the ones you see when you click on a deck. If you press the
Unbury button at the end of reviews, you'll get the other cards that were excluded
at the start.</p>
<h3><a class="header" href="#fuzz" id="fuzz">Fuzz</a></h3>
<p>The small random delay added to reviews is now reflected on the answer buttons, instead of
only being applied when answering.</p>
<h3><a class="header" href="#interday-learning" id="interday-learning">Interday learning</a></h3>
<p>Learning cards that cross a day boundary are now included in the review count, instead
of the learning count. They will now be affected by the daily review limit, and can be
automatically buried like review cards.</p>
<h3><a class="header" href="#filtered-decks" id="filtered-decks">Filtered decks</a></h3>
<p>Filtered decks with rescheduling disabled now show 4 buttons - the provided
delay applies to the Again button, and Hard/Good will use 1.5x and 2x the
provided delay. Easy will remove the card.</p>
<h2><a class="header" href="#add-ons-and-custom-scheduling" id="add-ons-and-custom-scheduling">Add-ons and custom scheduling</a></h2>
<p>The new scheduler is a ground-up rewrite, so add-ons that modified the old
scheduler's card gathering or answering routines will no longer work. It is no
longer possible to selectively replace parts of the scheduler's code (&quot;monkey
patching&quot;), so some add-ons may not be practical to port without significant
effort.</p>
<p>The new scheduler does provide some control over the scheduling however. As each
card is presented, the times and states associated with each answer button are
calculated in advance, and it is possible to modify the calculated scheduling
with some JavaScript code stored in your collection configuration.</p>
<p>For example, the following in the debug console:</p>
<pre><code class="language-python">mw.col.set_config(&quot;cardStateCustomizer&quot;, &quot;&quot;&quot;js code&quot;&quot;&quot;)
</code></pre>
<p>Where <code>js code</code> is something like:</p>
<pre><code class="language-javascript">// print the existing states
console.log(JSON.stringify(states, null, 4));

// load the debugger if the web inspector is open
debugger;

// if the hard button is a learning step, make it
// a 123 minute delay
if (states.hard.normal?.learning) {
  states.hard.normal.learning.scheduledSecs = 123 * 60;
}

// apply the same change in a rescheduling filtered deck
if (states.hard.filtered?.rescheduling?.originalState?.learning) {
  states.hard.filtered.rescheduling.originalState.learning.scheduledSecs =
    123 * 60;
}

// increase ease factor by 0.2 when Easy used on a review
if (states.good.normal?.review) {
  states.easy.normal.review.easeFactor =
    states.good.normal.review.easeFactor + 0.2;
}
</code></pre>
<p>Because this is implemented in JavaScript, it is not limited to the computer
version. The intention is for AnkiMobile, AnkiDroid and possibly AnkiWeb to
support this as well, so advanced users can make changes to the standard
scheduling behaviour that apply on all platforms.</p>
<p>The various scheduling states are described <a href="https://github.com/ankitects/anki/blob/9edac805adfe285cc92ed04dfeeffc1d1813c4d0/rslib/backend.proto#L1454">here</a>.</p>
<h2><a class="header" href="#stability" id="stability">Stability</a></h2>
<p>This is new code, with very little real-world testing yet. It does pass most of the
tests used to test the previous schedulers (the ones where behaviour is the same), but
it's possible there are still bugs lurking. Please make backups, and consider using an
add-on like <a href="https://ankiweb.net/shared/info/2179254157">this one</a> to keep an eye on your
scheduling until it has received more testing.</p>
<h2><a class="header" href="#trying-it-out" id="trying-it-out">Trying it out</a></h2>
<p>The following command in the debug console can be used to activate it:</p>
<pre><code class="language-python">mw.col.set_2021_test_scheduler_enabled(True)
</code></pre>
<p>Replace <code>True</code> with <code>False</code> to disable it again.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="intro.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="anki2.1.44.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="intro.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="anki2.1.44.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
